<div class="card">
  <div class="card-header">
    <div class="title">Manage Meals</div>
    <div class="actions">
      <div style="display: flex">
      <button (click)="addMealCategoryForm()" color="primary" class="addButtonClass" >
        <mat-icon style="display: flex;
  color: white;">add</mat-icon>
      </button>
      <select id="mealCategoryPicker" (change)="onCategoryChange($event)">
        <option value="0">Any</option>
      </select>
      </div>
      <button mat-flat-button color="primary" (click)="createMeal()">
        <mat-icon>add</mat-icon>&nbsp;New Meal
      </button>
      <mat-form-field appearance="outline" class="search">
        <mat-label>Search</mat-label>
        <input #mealsInput
               (input)="loadMealsByName(mealsInput.value)"
               matInput
               (keyup.enter)="onSearch($any($event.target).value)"
               placeholder="Name, descriptionâ€¦" />
      </mat-form-field>
    </div>
  </div>

  <div class="table-wrap">
    <table mat-table [dataSource]="rows" class="mat-elevation-z8">

      <!-- Image Column -->
      <ng-container matColumnDef="image">
        <th mat-header-cell *matHeaderCellDef><div class="cell-content">Image</div></th>
        <td mat-cell *matCellDef="let meal">
          <div class="cell-content">
            <img *ngIf="meal.imageField" [src]="meal.imageField" alt="{{meal.imageField}}" style="height: 80px; max-width: 80px" />
          </div>
        </td>
      </ng-container>

      <!-- Name Column -->
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef><div class="cell-content">Name</div></th>
        <td mat-cell *matCellDef="let meal" style="width: 350px"><div class="cell-content" style="width: 350px" >{{ meal.name }}</div></td>
      </ng-container>

      <!-- Category Column -->
      <ng-container matColumnDef="category">
        <th mat-header-cell *matHeaderCellDef><div class="cell-content">Category</div></th>
        <td mat-cell *matCellDef="let meal">
          <div class="cell-content">{{ getCategoryName$(meal.categoryId) | async }}</div>
        </td>
      </ng-container>

      <!-- Price Column -->
      <ng-container matColumnDef="basePrice">
        <th mat-header-cell *matHeaderCellDef><div class="cell-content">Price</div></th>
        <td mat-cell *matCellDef="let meal"><div class="cell-content">{{ meal.basePrice | currency }}</div></td>
      </ng-container>

      <!-- Available Column -->
      <ng-container matColumnDef="isAvailable">
        <th mat-header-cell *matHeaderCellDef><div class="cell-content">Available</div></th>
        <td mat-cell *matCellDef="let meal"><div class="cell-content">{{ meal.isAvailable ? 'Yes' : 'No' }}</div></td>
      </ng-container>

      <!-- Featured Column -->
      <ng-container matColumnDef="isFeatured">
        <th mat-header-cell *matHeaderCellDef><div class="cell-content">Featured</div></th>
        <td mat-cell *matCellDef="let meal"><div class="cell-content">{{ meal.isFeatured ? 'Yes' : 'No' }}</div></td>
      </ng-container>

      <!-- Ingredients Column -->
      <ng-container matColumnDef="ingredientsCount">
        <th mat-header-cell *matHeaderCellDef><div class="cell-content">Ingredients</div></th>
        <td mat-cell *matCellDef="let meal"><div class="cell-content">{{ meal.ingredientsCount }}</div></td>
      </ng-container>

      <!-- Actions Column -->
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef><div class="cell-content">Actions</div></th>
        <td mat-cell *matCellDef="let meal">
          <div class="cell-content action-buttons">
            <button mat-icon-button class="green-icon" (click)="editMeal(meal.id)">
              <mat-icon>edit</mat-icon>
            </button>
            <button mat-icon-button class="red-icon" (click)="deleteMeal(meal.id)">
              <mat-icon>delete</mat-icon>
            </button>
          </div>
        </td>
      </ng-container>

      <!-- Header & Row -->
      <tr mat-header-row *matHeaderRowDef="columns"></tr>
      <tr mat-row *matRowDef="let row; columns: columns;"></tr>

    </table>
  </div>

  <mat-paginator
    [length]="total"
    [pageSize]="pageSize"
    (page)="onPage($event)">
  </mat-paginator>
</div>
